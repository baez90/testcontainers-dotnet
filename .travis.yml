language: csharp

solution: testcontainers-dotnet.sln

mono: none
dotnet: 2.1.502

install:
  - dotnet restore
  - dotnet tool install --global dotnet-sonarscanner
  - PATH=~/.dotnet/tools:$PATH

script:
  - dotnet sonarscanner begin /k:"testcontainers-dotnet" /d:sonar.organization="isen-ng-github" /d:sonar.host.url="https://sonarcloud.io" /d:sonar.login="2457b2d28e2da7ba84edcf68b53e9650217c5b44"
  - dotnet build
  - dotnet sonarscanner end /d:sonar.login="2457b2d28e2da7ba84edcf68b53e9650217c5b44"
  - dotnet test /p:CollectCoverage=true /p:CoverletOutputFormat='json%2copencover' /p:CoverletOutput=../bin/coverage/ /p:MergeWith='../bin/coverage/coverage.json'
    
after_success:
  - curl -s https://codecov.io/bash > codecov
  - chmod +x codecov
  - ./codecov -f "test/bin/coverage/coverage.opencover.xml"
